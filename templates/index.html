{% extends 'base.html' %}

{% block title %}Indian Income Tax Calculator 2025-26{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-9">
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h4 class="card-title mb-0">
                    <i class="fas fa-rupee-sign me-2"></i>
                    Income & Deductions (FY 2025-26)
                </h4>
            </div>
            <div class="card-body">
                <form id="taxCalculatorForm">
                    <div class="row mb-3"> <div class="col-md-12">
                            <h5 class="border-bottom pb-2 mb-3">
                                <i class="fas fa-user me-2"></i> Basic Information
                            </h5>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="annual_salary" class="form-label">Annual Gross Income (₹) <span class="text-danger">*</span></label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-rupee-sign"></i></span>
                                <input type="number" class="form-control" id="annual_salary" name="annual_salary"
                                       placeholder="e.g., 1000000" required min="0" step="any">
                            </div>
                            <div class="form-text">Enter total income before any deductions.</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="age_category" class="form-label">Age Category <span class="text-danger">*</span></label>
                            <select class="form-select" id="age_category" name="age_category" required>
                                <option value="below_60" selected>Below 60 years</option>
                                <option value="60_to_80">60 to 80 years</option>
                                <option value="above_80">Above 80 years</option>
                            </select>
                            <div class="form-text">Relevant for Old Regime slabs.</div>
                        </div>
                         <div class="col-md-6 mb-3">
                            <div class="form-check mt-4 pt-2"> <input class="form-check-input" type="checkbox" value="on" id="is_salaried" name="is_salaried" checked>
                                <label class="form-check-label" for="is_salaried">
                                    Are you Salaried / Pensioner?
                                </label>
                            </div>
                             <div class="form-text">Check if eligible for Standard Deduction.</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="professional_tax" class="form-label">Professional Tax Paid (Annually) (₹)</label>
                             <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-briefcase"></i></span>
                                <input type="number" class="form-control" id="professional_tax" name="professional_tax"
                                       placeholder="e.g., 2400" min="0" value="0" step="any">
                            </div>
                            <div class="form-text">Deductible up to ₹2,500 in Old Regime.</div>
                        </div>
                    </div>

                    <div class="row mb-3"> <div class="col-md-12">
                            <h5 class="border-bottom pb-2 mb-3">
                                <i class="fas fa-hand-holding-dollar me-2"></i> Deductions (Primarily for Old Regime)
                                <button type="button" class="btn btn-sm btn-outline-info float-end"
                                        data-bs-toggle="collapse" data-bs-target="#deductionsHelp">
                                    <i class="fas fa-question-circle"></i> Help
                                </button>
                            </h5>
                             <div id="deductionsHelp" class="collapse mb-3">
                                <div class="card card-body bg-secondary bg-opacity-10 border-secondary"> <small>
                                    <p class="mb-1"><strong>80C Limit (₹1.5L):</strong> PPF, EPF, LIC, ELSS, NSC, Home Loan Principal, Tuition Fees, etc.</p>
                                    <p class="mb-1"><strong>80D Limit (up to ₹1L):</strong> Medical Insurance Premium (depends on age).</p>
                                    <p class="mb-1"><strong>24(b) Limit (up to ₹2L loss):</strong> Interest on Housing Loan (Self-occupied).</p>
                                    <p class="mb-1"><strong>80CCD(1B) Limit (₹50k):</strong> Additional NPS Contribution.</p>
                                    <p class="mb-1"><strong>80TTA/TTB Limit (₹10k/₹50k):</strong> Interest on Savings/Deposits.</p>
                                     <p class="mb-1"><strong>80E:</strong> Interest on Education Loan (No limit on amount for deduction period).</p>
                                    <p class="mb-0">Enter amounts you actually invested/paid.</p>
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="section_80c" class="form-label">80C Investments (₹)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-piggy-bank"></i></span>
                                <input type="number" class="form-control" id="section_80c" name="section_80c"
                                       placeholder="Max 1,50,000" min="0" value="0" step="any">
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="section_80d" class="form-label">80D Medical Premium (₹)</label>
                             <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-briefcase-medical"></i></span>
                                <input type="number" class="form-control" id="section_80d" name="section_80d"
                                       placeholder="Max 1,00,000" min="0" value="0" step="any">
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="section_24b" class="form-label">24(b) Home Loan Interest (₹)</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-house-chimney"></i></span>
                                <input type="number" class="form-control" id="section_24b" name="section_24b"
                                       placeholder="Max deduction 2,00,000 loss" min="0" value="0" step="any">
                             </div>
                        </div>
                         <div class="col-md-6 mb-3">
                            <label for="section_80ccd_1b" class="form-label">80CCD(1B) NPS (₹)</label>
                             <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-umbrella"></i></span>
                                <input type="number" class="form-control" id="section_80ccd_1b" name="section_80ccd_1b"
                                       placeholder="Max 50,000" min="0" value="0" step="any">
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="section_80tta_ttb" class="form-label">80TTA/TTB Savings Interest (₹)</label>
                             <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-sack-dollar"></i></span>
                                <input type="number" class="form-control" id="section_80tta_ttb" name="section_80tta_ttb"
                                       placeholder="Max 10k / 50k" min="0" value="0" step="any">
                            </div>
                        </div>
                         <div class="col-md-6 mb-3">
                            <label for="section_80e" class="form-label">80E Education Loan Interest (₹)</label>
                             <div class="input-group">
                                <span class="input-group-text"><i class="fa-solid fa-graduation-cap"></i></span>
                                <input type="number" class="form-control" id="section_80e" name="section_80e"
                                       placeholder="Enter amount paid" min="0" value="0" step="any">
                            </div>
                        </div>

                        <div class="col-md-12 mb-3">
                            <button type="button" class="btn btn-sm btn-outline-secondary w-100"
                                    data-bs-toggle="collapse" data-bs-target="#advancedDeductions">
                                <i class="fas fa-chevron-down me-2"></i> Show Less Common Deductions
                            </button>
                        </div>

                        <div id="advancedDeductions" class="collapse row">
                           <div class="col-md-6 mb-3">
                                <label for="section_80g" class="form-label">80G Donations (Eligible Amt) (₹)</label>
                                 <div class="input-group">
                                     <span class="input-group-text"><i class="fa-solid fa-hand-holding-heart"></i></span>
                                    <input type="number" class="form-control" id="section_80g" name="section_80g"
                                           placeholder="Enter eligible amount" min="0" value="0" step="any">
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="section_80ddb" class="form-label">80DDB Medical Treatment (₹)</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fa-solid fa-stethoscope"></i></span>
                                    <input type="number" class="form-control" id="section_80ddb" name="section_80ddb"
                                           placeholder="Max 40k / 1L" min="0" value="0" step="any">
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="section_80gg" class="form-label">80GG Rent Paid (No HRA) (₹)</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fa-solid fa-building"></i></span>
                                    <input type="number" class="form-control" id="section_80gg" name="section_80gg"
                                           placeholder="Subject to limits" min="0" value="0" step="any">
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="section_80u" class="form-label">80U Disability Deduction (₹)</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="fa-solid fa-wheelchair"></i></span>
                                    <input type="number" class="form-control" id="section_80u" name="section_80u"
                                           placeholder="75k / 1.25L" min="0" value="0" step="any">
                                </div>
                            </div>
                        </div> </div> <div class="d-grid gap-2 d-md-flex justify-content-md-center mt-4"> <button type="button" id="resetForm" class="btn btn-secondary col-md-3">
                            <i class="fas fa-redo me-2"></i> Reset
                        </button>
                        <button type="submit" class="btn btn-primary col-md-3">
                            <i class="fas fa-calculator me-2"></i> Calculate Tax
                        </button>
                    </div>
                </form>
            </div> </div> <div id="resultsSection" class="card d-none">
            <div class="card-header bg-success text-white">
                <h4 class="card-title mb-0">
                    <i class="fas fa-chart-line me-2"></i> Tax Calculation Results & Comparison
                </h4>
            </div>
            <div class="card-body">
                <div id="taxRecommendation" class="alert alert-success mb-4 text-center fs-5"> <i class="fas fa-check-circle me-2"></i>
                    <span id="recommendationText">Calculating...</span>
                </div>

                <ul class="nav nav-tabs nav-fill mb-3" id="resultTabs" role="tablist"> <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="comparison-tab" data-bs-toggle="tab"
                                data-bs-target="#comparison" type="button" role="tab" aria-selected="true">
                            <i class="fas fa-balance-scale me-1"></i> Comparison
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="old-regime-tab" data-bs-toggle="tab"
                                data-bs-target="#oldRegimeTab" type="button" role="tab" aria-selected="false">
                            <i class="fas fa-file-invoice-dollar me-1"></i> Old Regime
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="new-regime-tab" data-bs-toggle="tab"
                                data-bs-target="#newRegimeTab" type="button" role="tab" aria-selected="false">
                            <i class="fas fa-star me-1"></i> New Regime
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="resultTabsContent">
                    <div class="tab-pane fade show active" id="comparison" role="tabpanel">
                        <div class="row g-3"> <div class="col-lg-6">
                                <div class="card h-100">
                                    <div class="card-body d-flex flex-column">
                                        <h5 class="card-title text-center mb-2">Tax Liability Comparison</h5>
                                        <div class="chart-container flex-grow-1" style="position: relative; min-height:250px; width:100%">
                                             <canvas id="taxComparisonChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-lg-6">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title text-center mb-2">Quick Summary</h5>
                                        <div class="table-responsive">
                                            <table class="table table-sm table-bordered align-middle small"> <thead class="table-light">
                                                    <tr class="text-center">
                                                        <th>Parameter</th>
                                                        <th>Old Regime</th>
                                                        <th>New Regime</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr>
                                                        <td>Gross Income</td>
                                                        <td class="text-end"><span id="oldGrossIncome">-</span></td>
                                                        <td class="text-end"><span id="newGrossIncome">-</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Std. Deduction</td>
                                                        <td class="text-end"><span id="oldStandardDeduction">-</span></td>
                                                        <td class="text-end"><span id="newStandardDeduction">-</span></td>
                                                    </tr>
                                                     <tr>
                                                        <td>Prof. Tax Ded.</td>
                                                        <td class="text-end"><span id="oldProfTaxDed">-</span></td>
                                                         <td class="text-center table-secondary">N/A</td>
                                                    </tr>
                                                     <tr>
                                                        <td>House Prop. Loss</td>
                                                        <td class="text-end"><span id="oldHPLossDed">-</span></td>
                                                        <td class="text-center table-secondary">N/A</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Chap VI-A Ded.</td>
                                                        <td class="text-end"><span id="oldOtherDeductions">-</span></td>
                                                        <td class="text-center table-secondary">N/A</td>
                                                    </tr>
                                                    <tr class="table-light">
                                                        <td><strong>Taxable Income</strong></td>
                                                        <td class="text-end"><strong><span id="oldTaxableIncome">-</span></strong></td>
                                                        <td class="text-end"><strong><span id="newTaxableIncome">-</span></strong></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Base Tax</td>
                                                        <td class="text-end"><span id="oldBaseTaxComp">-</span></td>
                                                        <td class="text-end"><span id="newBaseTaxComp">-</span></td>
                                                    </tr>
                                                      <tr>
                                                        <td>Rebate 87A</td>
                                                        <td class="text-end"><span id="oldRebateComp">-</span></td>
                                                        <td class="text-end"><span id="newRebateComp">-</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Surcharge</td>
                                                        <td class="text-end"><span id="oldSurchargeComp">-</span></td>
                                                        <td class="text-end"><span id="newSurchargeComp">-</span></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Cess (4%)</td>
                                                        <td class="text-end"><span id="oldCessComp">-</span></td>
                                                        <td class="text-end"><span id="newCessComp">-</span></td>
                                                    </tr>
                                                    <tr class="table-active fw-bolder fs-6"> <td>Total Tax</td>
                                                        <td class="text-end"><span id="oldTaxLiability">-</span></td>
                                                        <td class="text-end"><span id="newTaxLiability">-</span></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="alert alert-secondary mt-2 small" id="taxSavingsText"> Calculate your tax to see potential savings.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> <div class="tab-pane fade" id="oldRegimeTab" role="tabpanel">
                         <div class="row g-3">
                            <div class="col-lg-6">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title mb-3">Old Regime: Calculation Details</h5>
                                        <table class="table table-sm table-bordered small">
                                            <tbody>
                                                <tr><td>Gross Income</td><td class="text-end"><span id="oldDetailGrossIncome">-</span></td></tr>
                                                <tr><td>(-) Standard Deduction</td><td class="text-end"><span id="oldDetailStandardDeduction">-</span></td></tr>
                                                <tr><td>(-) Professional Tax</td><td class="text-end"><span id="oldDetailProfTaxDed">-</span></td></tr>
                                                <tr><td>(-) House Property Loss Adj.</td><td class="text-end"><span id="oldDetailHPLossDed">-</span></td></tr>
                                                <tr class="table-light"><td>Gross Total Income (Approx)</td><td class="text-end"><span id="oldDetailGTI">-</span></td></tr>
                                                <tr><td>(-) Chapter VI-A Deductions</td><td class="text-end"><span id="oldDetailChapVIADed">-</span></td></tr>
                                                <tr class="table-primary"><td><strong>Taxable Income</strong></td><td class="text-end"><strong><span id="oldDetailTaxableIncome">-</span></strong></td></tr>
                                                <tr><td>Base Tax on Income</td><td class="text-end"><span id="oldDetailBaseTax">-</span></td></tr>
                                                <tr><td>(-) Rebate u/s 87A</td><td class="text-end"><span id="oldDetailRebate">-</span></td></tr>
                                                <tr class="table-light"><td>Tax after Rebate</td><td class="text-end"><span id="oldDetailTaxAfterRebate">-</span></td></tr>
                                                <tr><td>(+) Surcharge</td><td class="text-end"><span id="oldDetailSurcharge">-</span></td></tr>
                                                <tr class="table-light"><td>Tax + Surcharge</td><td class="text-end"><span id="oldDetailTaxPlusSurcharge">-</span></td></tr>
                                                <tr><td>(+) Health & Edu Cess (4%)</td><td class="text-end"><span id="oldDetailCess">-</span></td></tr>
                                                <tr class="table-success fw-bolder fs-6"><td>Total Tax Liability</td><td class="text-end"><span id="oldDetailTaxLiability">-</span></td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                 <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title mb-3">Old Regime: Tax Slabs</h5>
                                        <p class="small text-muted">Slabs shown based on selected age category.</p>
                                        <div class="table-responsive">
                                            <table class="table table-sm table-bordered small">
                                                <thead class="table-light">
                                                    <tr><th>Income Range (₹)</th><th class="text-center">Tax Rate</th></tr>
                                                </thead>
                                                <tbody id="oldRegimeSlabsBody">
                                                    <tr><td colspan="2" class="text-center">Select age category to view slabs.</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                         <div class="alert alert-warning small mt-3">
                                             <i class="fas fa-exclamation-triangle me-2"></i> Allows various deductions (80C, 80D, HRA, Home Loan Interest etc.) but has higher base rates and lower rebate threshold (₹5L).
                                         </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> <div class="tab-pane fade" id="newRegimeTab" role="tabpanel">
                         <div class="row g-3">
                            <div class="col-lg-6">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title mb-3">New Regime (FY 2025-26): Calculation Details</h5>
                                        <table class="table table-sm table-bordered small">
                                            <tbody>
                                                <tr><td>Gross Income</td><td class="text-end"><span id="newDetailGrossIncome">-</span></td></tr>
                                                <tr><td>(-) Standard Deduction</td><td class="text-end"><span id="newDetailStandardDeduction">-</span></td></tr>
                                                <tr class="table-primary"><td><strong>Taxable Income</strong></td><td class="text-end"><strong><span id="newDetailTaxableIncome">-</span></strong></td></tr>
                                                <tr><td>Base Tax on Income</td><td class="text-end"><span id="newDetailBaseTax">-</span></td></tr>
                                                <tr><td>(-) Rebate u/s 87A</td><td class="text-end"><span id="newDetailRebate">-</span></td></tr>
                                                 <tr class="table-light"><td>Tax after Rebate</td><td class="text-end"><span id="newDetailTaxAfterRebate">-</span></td></tr>
                                                <tr><td>(+) Surcharge</td><td class="text-end"><span id="newDetailSurcharge">-</span></td></tr>
                                                <tr class="table-light"><td>Tax + Surcharge</td><td class="text-end"><span id="newDetailTaxPlusSurcharge">-</span></td></tr>
                                                <tr><td>(+) Health & Edu Cess (4%)</td><td class="text-end"><span id="newDetailCess">-</span></td></tr>
                                                <tr class="table-success fw-bolder fs-6"><td>Total Tax Liability</td><td class="text-end"><span id="newDetailTaxLiability">-</span></td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                 <div class="card h-100">
                                    <div class="card-body">
                                        <h5 class="card-title mb-3">New Regime: Tax Slabs (FY 2025-26)</h5>
                                         <div class="table-responsive">
                                            <table class="table table-sm table-bordered small">
                                                <thead class="table-light">
                                                    <tr><th>Income Range (₹)</th><th class="text-center">Tax Rate</th></tr>
                                                </thead>
                                                <tbody>
                                                    <tr><td>Up to 4,00,000</td><td class="text-center">0%</td></tr>
                                                    <tr><td>4,00,001 - 8,00,000</td><td class="text-center">5%</td></tr>
                                                    <tr><td>8,00,001 - 12,00,000</td><td class="text-center">10%</td></tr>
                                                    <tr><td>12,00,001 - 16,00,000</td><td class="text-center">15%</td></tr>
                                                    <tr><td>16,00,001 - 20,00,000</td><td class="text-center">20%</td></tr>
                                                    <tr><td>20,00,001 - 24,00,000</td><td class="text-center">25%</td></tr>
                                                    <tr><td>Above 24,00,000</td><td class="text-center">30%</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="alert alert-info small mt-3">
                                             <i class="fas fa-star me-2"></i> Default regime with lower rates, ₹75k Standard Deduction, and **Zero Tax up to ₹12 Lakh taxable income** due to Section 87A rebate. Most deductions (80C, 80D, HRA etc.) are not allowed.
                                         </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> </div> </div> </div> </div> <div class="col-lg-3">
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0"><i class="fas fa-lightbulb me-2"></i> Key Points (FY 2025-26)</h5>
            </div>
            <div class="card-body small">
                <ul class="list-unstyled mb-0">
                    <li class="mb-2"><i class="fas fa-star text-warning me-1"></i> <strong>New Regime (Default):</strong></li>
                    <ul style="padding-left: 20px;">
                         <li>Basic Exemption: ₹4 Lakh</li>
                         <li>Std. Deduction: ₹75,000</li>
                         <li>Rebate u/s 87A: Zero tax up to ₹12 Lakh taxable income</li>
                         <li>Most other deductions (80C, HRA etc.) disallowed.</li>
                    </ul>
                     <li class="mt-3 mb-2"><i class="fas fa-book text-primary me-1"></i> <strong>Old Regime (Optional):</strong></li>
                     <ul style="padding-left: 20px;">
                         <li>Basic Exemption: ₹2.5L / ₹3L / ₹5L (by age)</li>
                         <li>Std. Deduction: ₹50,000</li>
                         <li>Allows deductions (80C, 80D, 24b, HRA etc.)</li>
                          <li>Rebate u/s 87A: Up to ₹12.5k if taxable income ≤ ₹5L.</li>
                    </ul>
                </ul>
            </div>
        </div>
         <div class="card mb-4">
            <div class="card-header bg-warning text-dark">
                <h5 class="card-title mb-0"><i class="fas fa-exclamation-triangle me-2"></i> Disclaimer</h5>
            </div>
            <div class="card-body small">
               Calculations are based on Budget 2025 provisions for FY 2025-26. Rules are subject to final legislation. This tool is for estimation only. Consult a tax professional for personalized advice.
            </div>
        </div>
    </div> </div> {% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/calculator.js') }}"></script>
<script src="{{ url_for('static', filename='js/charts.js') }}"></script>
{% endblock %}